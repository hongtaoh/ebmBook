{"title":"Estimate Distribution Parameters","markdown":{"yaml":{"title":"Estimate Distribution Parameters"},"headingText":"Constrained K-Means","containsRefs":false,"markdown":"\n\n\n\n\nGiven a biomarker's measurements, how can we estimate $\\mathcal N(\\theta_{\\mu}, \\theta_{\\sigma})$ and $\\mathcal N(\\phi_{\\mu}, \\phi_{\\sigma})$?\n\n\n\n\nThe first method we can use is constrained K-means, implemented by @behrouz_babaki_2017_831850.\n\nWe choose constrained K-Means instead of the standard K-Means algorithm because we know all healthy participants have to belong to the same cluster. The constrained K-Means algorithm can satisfy this constraint. \n\nNow let's compare the results using plots:\n\nIt turns out the result is generally okay. \n\n## Conjugate Priors\n\nThe second method we may utilize is conjugate priors. Conjugacy occurs when the posterior distribution is in the same family of distribution as the prior distribution, but with new parameter values. \n\nWhy conjugacy is important? Because without it, one has to do the integration, which oftentimes is hard. \n\nThree major conjugate families:\n\n- Beta-Binomial\n- Gamma-Poisson\n- Normal-Normal\n\nIn our example, we assume that the measurement data for each biomarker follows a normal distribution; however, we do not know the exact $\\mu$ and $\\sigma$. Our job is to estimate the two parameters for each biomarker based on the data we have. \n\nAccording to [*An Introduction to Bayesian Thinking*](https://statswithr.github.io/book/inference-and-decision-making-with-multiple-parameters.html#sec:normal-gamma) by @clydeintroduction, if the data comes from a normal distribution with unknown $\\mu$ and $\\sigma$, the conjugate prior for $\\mu$ has a normal distribution with mean $m_0$ and variance $\\frac{\\sigma^2}{n_0}$. The conjugate prior for $\\frac{1}{\\sigma^2}$ has a Gamma distribution with shape $\\frac{v_0}{2}$ and rate $\\frac{v_0 s_0^{2}}{2}$ where\n\n- $m_0$: prior estimate of $\\mu$.\n- $n_0$: how strongly is the prior belief in $m_0$ is held.\n- $s_0^2$: prior estimate of $\\sigma^2$.\n- $v_0$: prior degress of freedome, influencing the certainty of $s_0^2$.\n\nThat is to say: \n\n$$\\mu | \\sigma^2 \\sim \\mathcal{N}(m_0, \\sigma^2/n_0)$$\n\n$$1/\\sigma^2 \\sim Gamma\\left(\\frac{v_0}{2}, \\frac{v_0 s_0^2}{2} \\right)$$\n\nCombined, we have:\n\n$$(\\mu, 1/\\sigma^2) \\sim NormalGamma(m_0, n_0, s_0^2, v_0)$$\n\nThe posterior also follows a Normal-Gamma distribution:\n\n$$(\\mu, 1/\\sigma^2) | data \\sim NormalGamma(m_n, n_n, s_n^2, v_n)$$\n\nMore specifically\n\n$$1/\\sigma^2 | data \\sim Gamma(v_n/2, s_n^2 v_n/2)$$\n\n$$\\mu | data, \\sigma^2 \\sim \\mathcal{N}(m_n, \\sigma^2/n_n)$$\n\nBased on the above two equations, we know that the mean of posterior mean is $m_n$ and the mean of the posterior variance is $(s_n^2 v_n/2)/(v_n/2)$. This is beceause the expected value of $Gamma(\\alpha, \\beta)$ is $\\frac{\\alpha}{\\beta}$.\n\nwhere \n\n- $m_n$: posterior mean, mode, and median for $\\mu$\n- $n_n$: posterior sample size \n- $s_n^2$: posterior variance \n- $v_n$: posterior degrees of freedome\n\nThe updating rules to get the new hyper-parameters: \n\n<!-- $$m_n = \\frac{n \\bar{y} + n_0m_0}{n + n_0}$$ -->\n\n$$m_n = \\frac{n}{n+n_0} \\bar{y} + \\frac{n_0}{n+n_0}m_0$$\n\n$$n_n = n_0 + n$$\n\n$$v_n = v_0 + n$$\n\n$$s_n^2 = \\frac{1}{v_n}\\left[s^2(n-1) + s_0^2v_0 + \\frac{n_0n}{n_n}(\\bar{y}-m_0)^2\\right]$$\n\nwhere\n\n- $n$: sample size\n- $\\bar{y}$: sample mean \n- $s^2$: sample variance\n\n## Conclusion\n\nThe result from conjugate priors looks better than that from constrained kmeans. However, to use conjugate priors, we assume that we know $S$ and $k_j$ for each participant, which are very hardly known. The constrained kmeans algorithm does not require any prior knowledge of $S$ nor $k_j$.\n","srcMarkdownNoYaml":"\n\n\n\n\nGiven a biomarker's measurements, how can we estimate $\\mathcal N(\\theta_{\\mu}, \\theta_{\\sigma})$ and $\\mathcal N(\\phi_{\\mu}, \\phi_{\\sigma})$?\n\n\n\n## Constrained K-Means\n\nThe first method we can use is constrained K-means, implemented by @behrouz_babaki_2017_831850.\n\nWe choose constrained K-Means instead of the standard K-Means algorithm because we know all healthy participants have to belong to the same cluster. The constrained K-Means algorithm can satisfy this constraint. \n\nNow let's compare the results using plots:\n\nIt turns out the result is generally okay. \n\n## Conjugate Priors\n\nThe second method we may utilize is conjugate priors. Conjugacy occurs when the posterior distribution is in the same family of distribution as the prior distribution, but with new parameter values. \n\nWhy conjugacy is important? Because without it, one has to do the integration, which oftentimes is hard. \n\nThree major conjugate families:\n\n- Beta-Binomial\n- Gamma-Poisson\n- Normal-Normal\n\nIn our example, we assume that the measurement data for each biomarker follows a normal distribution; however, we do not know the exact $\\mu$ and $\\sigma$. Our job is to estimate the two parameters for each biomarker based on the data we have. \n\nAccording to [*An Introduction to Bayesian Thinking*](https://statswithr.github.io/book/inference-and-decision-making-with-multiple-parameters.html#sec:normal-gamma) by @clydeintroduction, if the data comes from a normal distribution with unknown $\\mu$ and $\\sigma$, the conjugate prior for $\\mu$ has a normal distribution with mean $m_0$ and variance $\\frac{\\sigma^2}{n_0}$. The conjugate prior for $\\frac{1}{\\sigma^2}$ has a Gamma distribution with shape $\\frac{v_0}{2}$ and rate $\\frac{v_0 s_0^{2}}{2}$ where\n\n- $m_0$: prior estimate of $\\mu$.\n- $n_0$: how strongly is the prior belief in $m_0$ is held.\n- $s_0^2$: prior estimate of $\\sigma^2$.\n- $v_0$: prior degress of freedome, influencing the certainty of $s_0^2$.\n\nThat is to say: \n\n$$\\mu | \\sigma^2 \\sim \\mathcal{N}(m_0, \\sigma^2/n_0)$$\n\n$$1/\\sigma^2 \\sim Gamma\\left(\\frac{v_0}{2}, \\frac{v_0 s_0^2}{2} \\right)$$\n\nCombined, we have:\n\n$$(\\mu, 1/\\sigma^2) \\sim NormalGamma(m_0, n_0, s_0^2, v_0)$$\n\nThe posterior also follows a Normal-Gamma distribution:\n\n$$(\\mu, 1/\\sigma^2) | data \\sim NormalGamma(m_n, n_n, s_n^2, v_n)$$\n\nMore specifically\n\n$$1/\\sigma^2 | data \\sim Gamma(v_n/2, s_n^2 v_n/2)$$\n\n$$\\mu | data, \\sigma^2 \\sim \\mathcal{N}(m_n, \\sigma^2/n_n)$$\n\nBased on the above two equations, we know that the mean of posterior mean is $m_n$ and the mean of the posterior variance is $(s_n^2 v_n/2)/(v_n/2)$. This is beceause the expected value of $Gamma(\\alpha, \\beta)$ is $\\frac{\\alpha}{\\beta}$.\n\nwhere \n\n- $m_n$: posterior mean, mode, and median for $\\mu$\n- $n_n$: posterior sample size \n- $s_n^2$: posterior variance \n- $v_n$: posterior degrees of freedome\n\nThe updating rules to get the new hyper-parameters: \n\n<!-- $$m_n = \\frac{n \\bar{y} + n_0m_0}{n + n_0}$$ -->\n\n$$m_n = \\frac{n}{n+n_0} \\bar{y} + \\frac{n_0}{n+n_0}m_0$$\n\n$$n_n = n_0 + n$$\n\n$$v_n = v_0 + n$$\n\n$$s_n^2 = \\frac{1}{v_n}\\left[s^2(n-1) + s_0^2v_0 + \\frac{n_0n}{n_n}(\\bar{y}-m_0)^2\\right]$$\n\nwhere\n\n- $n$: sample size\n- $\\bar{y}$: sample mean \n- $s^2$: sample variance\n\n## Conclusion\n\nThe result from conjugate priors looks better than that from constrained kmeans. However, to use conjugate priors, we assume that we know $S$ and $k_j$ for each participant, which are very hardly known. The constrained kmeans algorithm does not require any prior knowledge of $S$ nor $k_j$.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"estPara.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","bibliography":["references.bib"],"theme":"cosmo","title":"Estimate Distribution Parameters"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"estPara.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt","title":"Estimate Distribution Parameters"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}